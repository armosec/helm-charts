minimal capabilities:
  1: |+
    raw: |+
      Thank you for installing kubescape-operator version 1.30.0-rc6.
      View your cluster's configuration scanning schedule:
      > kubectl -n kubescape get cj kubescape-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, set `.spec.schedule`:
      > kubectl -n kubescape edit cj kubescape-scheduler
      View your cluster's image scanning schedule:
      > kubectl -n kubescape get cj kubevuln-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, edit `.spec.schedule`:
      > kubectl -n kubescape edit cj kubevuln-scheduler

      View your image vulnerabilities scan summaries:
      > kubectl get vulnerabilitymanifestsummaries -A

      Detailed reports are also available:
      > kubectl get vulnerabilitymanifests -A

      kubescape-operator generates suggested network policies. To view them:
      > kubectl get generatednetworkpolicies -n <namespace>

  2: |
    apiVersion: v1
    data:
      accessKey: ZjMwNGQ3M2ItZDQzYy00MTJiLTgyZWEtZTRjODU5NDkzY2U2
      account: OWU2YzBjMmMtNmJkMC00OTE5LTgxNWItNTUwMzBkZTdjOWEw
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: cloud-secret
        app.kubernetes.io/component: cloud-secret
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: cloud-secret
      namespace: kubescape
    type: Opaque
  3: |
    apiVersion: v1
    data:
      clusterData: |
        {
          "serviceDiscovery": false,
          "vulnScanURL": "kubevuln:8080",
          "kubevulnURL": "kubevuln:8080",
          "kubescapeURL": "kubescape:8080",
          "clusterName": "kind-kind",
          "storage": true,
          "relevantImageVulnerabilitiesEnabled": true,
          "namespace": "kubescape",
          "imageVulnerabilitiesScanningEnabled": true,
          "postureScanEnabled": true,
          "otelCollector": false,
          "nodeAgent": "true",
          "maxImageSize": 5.36870912e+09,
          "maxSBOMSize": 2.097152e+07,
          "keepLocal": true,
          "scanTimeout": "5m",
          "scanEmbeddedSBOMs": false,
          "vexGeneration": false,
          "useDefaultMatchers": false,
          "storeFilteredSbom": false,
          "continuousPostureScan": false,
          "relevantImageVulnerabilitiesConfiguration": "enable"
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/infra: config
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-cloud-config
      namespace: kubescape
  4: |
    apiVersion: v1
    data:
      capabilities: |
        {
          "capabilities":{"admissionController":"enable","autoUpgrading":"disable","configurationScan":"enable","httpDetection":"enable","kubescapeOffline":"disable","malwareDetection":"disable","manageWorkloads":"enable","networkEventsStreaming":"enable","networkPolicyService":"enable","nodeProfileService":"enable","nodeSbomGeneration":"enable","nodeScan":"enable","prometheusExporter":"disable","relevancy":"enable","runtimeDetection":"enable","runtimeObservability":"enable","scanEmbeddedSBOMs":"disable","seccompProfileService":"enable","syncSBOM":"disable","testing":{"nodeAgentMultiplication":{"enabled":false,"replicas":5}},"vexGeneration":"disable","vulnerabilityScan":"enable"},
          "components":{"autoUpdater":{"enabled":false},"clamAV":{"enabled":false},"cloudSecret":{"create":true,"name":"cloud-secret"},"customCaCertificates":{"name":"custom-ca-certificates"},"hostScanner":{"enabled":true},"kubescape":{"enabled":true},"kubescapeScheduler":{"enabled":true},"kubevuln":{"enabled":true},"kubevulnScheduler":{"enabled":true},"nodeAgent":{"enabled":true},"operator":{"enabled":true},"otelCollector":{"enabled":false},"prometheusExporter":{"enabled":false},"serviceDiscovery":{"enabled":false},"storage":{"enabled":true},"synchronizer":{"enabled":false}},
          "configurations":{"persistence":"enable","priorityClass":{"daemonset":100000100,"enabled":true},"prometheusAnnotations":"disable"} ,
          "serviceScanConfig" :{"enabled":false,"interval":"1h"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-capabilities
        app.kubernetes.io/component: ks-capabilities
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-capabilities
      namespace: kubescape
  5: |
    apiVersion: v1
    data:
      .dockerconfigjson: eyJhdXRocyI6eyJxdWF5LmlvIjp7InVzZXJuYW1lIjoiYXJtb3NlYythcm1vc2VjX3JvIiwicGFzc3dvcmQiOiIiLCJlbWFpbCI6IiIsImF1dGgiOiJZWEp0YjNObFl5dGhjbTF2YzJWalgzSnZPZz09In19fQ==
    kind: Secret
    metadata:
      name: armosec-readonly
      namespace: kubescape
    type: kubernetes.io/dockerconfigjson
  6: |
    apiVersion: v1
    data:
      matchingRules.json: |
        {"match":[{"apiGroups":["apps"],"apiVersions":["v1"],"resources":["deployments"]}],"namespaces":["default"]}
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: cs-matching-rules
      namespace: kubescape
  7: |
    apiVersion: scheduling.k8s.io/v1
    description: This priority class is for node-agent daemonset pods
    globalDefault: false
    kind: PriorityClass
    metadata:
      annotations: null
      labels:
        app: kubescape-critical
        app.kubernetes.io/component: kubescape-critical
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-critical
    value: 1.000001e+08
  8: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"CommandName":"kubescapeScan","args":{"scanV1":{}}}]}'
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
  9: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        armo.tier: kubescape-scan
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubescape-scheduler
                app.kubernetes.io/component: kubescape-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.30.0-rc6
                armo.tier: kubescape-scan
                helm.sh/chart: kubescape-operator-1.30.0-rc6
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.15
                  imagePullPolicy: IfNotPresent
                  name: kubescape-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubescape-scheduler
                      readOnly: true
                      subPath: request-body.json
              imagePullSecrets:
                - name: armosec-readonly
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubescape
              tolerations: null
              volumes:
                - configMap:
                    name: kubescape-scheduler
                  name: kubescape-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  10: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - pods/proxy
          - namespaces
          - nodes
          - configmaps
          - services
          - serviceaccounts
          - endpoints
          - persistentvolumeclaims
          - persistentvolumes
          - limitranges
          - replicationcontrollers
          - podtemplates
          - resourcequotas
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apiregistration.k8s.io
        resources:
          - apiservices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
          - controllerrevisions
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - autoscaling
        resources:
          - horizontalpodautoscalers
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - coordination.k8s.io
        resources:
          - leases
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - discovery.k8s.io
        resources:
          - endpointslices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - hostdata.kubescape.cloud
        resources:
          - APIServerInfo
          - ControlPlaneInfo
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - policy
        resources:
          - poddisruptionbudgets
          - podsecuritypolicies
          - PodSecurityPolicy
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - clusterroles
          - clusterrolebindings
          - roles
          - rolebindings
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - storage.k8s.io
        resources:
          - csistoragecapacities
          - storageclasses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - ingresses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - extensions
        resources:
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - gateways
          - gatewayclasses
          - tcproutes
          - tlsroutes
          - udproutes
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - namespaces
        verbs:
          - update
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
        verbs:
          - create
          - get
          - update
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
  11: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  12: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8f40f001a3e31db9895e7bbb06ab070f25ab66c83b31d1929b273cfd22402097
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/host-scanner-configmap: b79b776156ef04b19218ce4a88b9d4428e6063076c1221a916d8ea42b8518274
          labels:
            app: kubescape
            app.kubernetes.io/component: kubescape
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.30.0-rc6
            helm.sh/chart: kubescape-operator-1.30.0-rc6
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - ksserver
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: KS_DOWNLOAD_ARTIFACTS
                  value: "true"
                - name: RULE_PROCESSING_GOMAXPROCS
                  value: ""
                - name: KS_DEFAULT_CONFIGMAP_NAME
                  value: kubescape-config
                - name: KS_DEFAULT_CONFIGMAP_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KS_CONTEXT
                  value: kind-kind
                - name: KS_DEFAULT_CLOUD_CONFIGMAP_NAME
                  value: ks-cloud-config
                - name: KS_ENABLE_HOST_SCANNER
                  value: "true"
                - name: KS_SKIP_UPDATE_CHECK
                  value: "false"
                - name: KS_HOST_SCAN_YAML
                  value: /home/nonroot/.kubescape/host-scanner.yaml
                - name: LARGE_CLUSTER_SIZE
                  value: "1500"
                - name: KS_EXCLUDE_NAMESPACES
                  value: kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public
              image: quay.io/kubescape/kubescape:v3.0.45
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubescape
              ports:
                - containerPort: 8080
                  name: http
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 600m
                  memory: 1Gi
                requests:
                  cpu: 250m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /home/nonroot/.kubescape
                  name: kubescape-volume
                  subPath: config.json
                - mountPath: /home/nonroot/.kubescape/host-scanner.yaml
                  name: host-scanner-definition
                  subPath: host-scanner-yaml
                - mountPath: /home/nonroot/results
                  name: results
                - mountPath: /home/nonroot/failed
                  name: failed
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
          imagePullSecrets:
            - name: armosec-readonly
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubescape
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                name: host-scanner-definition
              name: host-scanner-definition
            - emptyDir: {}
              name: kubescape-volume
            - emptyDir: {}
              name: results
            - emptyDir: {}
              name: failed
  13: |
    apiVersion: v1
    data:
      host-scanner-yaml: "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: host-scanner\n  namespace: kubescape\n  annotations:\n    \n  labels:\n    helm.sh/chart: kubescape-operator-1.30.0-rc6\n    app.kubernetes.io/name: kubescape-operator\n    app.kubernetes.io/instance: RELEASE-NAME\n    app.kubernetes.io/component: host-scanner\n    app.kubernetes.io/version: \"1.30.0-rc6\"\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubescape\n    app: host-scanner\n    tier: ks-control-plane\n    kubescape.io/ignore: \"true\"\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kubescape-operator\n      app.kubernetes.io/instance: RELEASE-NAME\n      app.kubernetes.io/component: host-scanner\n  template:\n    metadata:\n      annotations:\n        \n      labels:\n        helm.sh/chart: kubescape-operator-1.30.0-rc6\n        app.kubernetes.io/name: kubescape-operator\n        app.kubernetes.io/instance: RELEASE-NAME\n        app.kubernetes.io/component: host-scanner\n        app.kubernetes.io/version: \"1.30.0-rc6\"\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/part-of: kubescape\n        app: host-scanner\n        tier: ks-control-plane\n        kubescape.io/ignore: \"true\"\n        kubescape.io/tier: \"core\"\n        name: host-scanner\n    spec:\n      nodeSelector:\n        kubernetes.io/os: linux\n      affinity:\n      tolerations:\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/control-plane\n          operator: Exists\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/master\n          operator: Exists\n      imagePullSecrets:\n      - name: armosec-readonly\n      containers:\n      - name: host-sensor\n        image: \"quay.io/kubescape/host-scanner:v1.0.78\"\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: true\n          privileged: true\n          readOnlyRootFilesystem: true\n          procMount: Unmasked\n        env:\n        - name: KS_LOGGER_LEVEL\n          value: \"info\"\n        - name: KS_LOGGER_NAME\n          value: \"zap\"\n        ports:\n          - name: scanner # Do not change port name\n            containerPort: 7888\n            protocol: TCP\n        resources:\n          limits:\n            cpu: 0.4m\n            memory: 400Mi\n          requests:\n            cpu: 0.1m\n            memory: 200Mi\n        volumeMounts:\n        - mountPath: /host_fs\n          name: host-filesystem\n        startupProbe:\n          httpGet:\n            path: /readyz\n            port: 7888\n          failureThreshold: 30\n          periodSeconds: 1\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 7888\n          periodSeconds: 10\n      terminationGracePeriodSeconds: 120\n      dnsPolicy: ClusterFirstWithHostNet\n      serviceAccountName: node-agent\n      automountServiceAccountToken: false\n      volumes:\n      - hostPath:\n          path: /\n          type: Directory\n        name: host-filesystem\n      hostPID: true\n      hostIPC: true"
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: host-scanner-definition
      namespace: kubescape
  14: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    rules:
      - apiGroups:
          - apps
        resources:
          - daemonsets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  15: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  16: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      ports:
        - name: http
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  17: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
  18: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"commandName":"scan","designators":[{"designatorType":"Attributes","attributes":{}}]}]}'
    kind: ConfigMap
    metadata:
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
  19: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        armo.tier: vuln-scan
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubevuln-scheduler
                app.kubernetes.io/component: kubevuln-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.30.0-rc6
                armo.tier: vuln-scan
                helm.sh/chart: kubescape-operator-1.30.0-rc6
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.15
                  imagePullPolicy: IfNotPresent
                  name: kubevuln-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubevuln-scheduler
                      readOnly: true
                      subPath: request-body.json
              imagePullSecrets:
                - name: armosec-readonly
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubevuln
              tolerations: null
              volumes:
                - configMap:
                    name: kubevuln-scheduler
                  name: kubevuln-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  20: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    rules:
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - openvulnerabilityexchangecontainers
          - sbomsyfts
          - sbomsyftfiltereds
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
        verbs:
          - get
          - watch
          - list
  21: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubevuln
    subjects:
      - kind: ServiceAccount
        name: kubevuln
        namespace: kubescape
  22: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubevuln
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8f40f001a3e31db9895e7bbb06ab070f25ab66c83b31d1929b273cfd22402097
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
          labels:
            app: kubevuln
            app.kubernetes.io/component: kubevuln
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.30.0-rc6
            helm.sh/chart: kubescape-operator-1.30.0-rc6
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - args:
                - -alsologtostderr
                - -v=4
                - 2>&1
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: PRINT_POST_JSON
                  value: ""
                - name: CA_MAX_VULN_SCAN_ROUTINES
                  value: "1"
              image: quay.io/kubescape/kubevuln:v0.3.98
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubevuln
              ports:
                - containerPort: 8080
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: 8080
              resources:
                limits:
                  cpu: 1500m
                  ephemeral-storage: 10Gi
                  memory: 5000Mi
                requests:
                  cpu: 300m
                  ephemeral-storage: 5Gi
                  memory: 1000Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /home/nonroot/anchore-resources/db
                  name: grype-db-cache
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /home/nonroot/.cache/grype
                  name: grype-db
          imagePullSecrets:
            - name: armosec-readonly
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubevuln
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - emptyDir: {}
              name: tmp-dir
            - emptyDir: {}
              name: grype-db-cache
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: grype-db
  23: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      ports:
        - port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  24: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
  25: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    rules:
      - apiGroups:
          - ""
        resources:
          - nodes
          - nodes/proxy
          - services
          - endpoints
          - namespaces
          - configmaps
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
          - sbomsyfts
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - create
          - patch
          - get
      - apiGroups:
          - kubescape.io
        resources:
          - rules
        verbs:
          - list
          - watch
  26: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: node-agent
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  27: |
    apiVersion: v1
    data:
      config.json: |
        {
            "applicationProfileServiceEnabled": true,
            "prometheusExporterEnabled": false,
            "runtimeDetectionEnabled": true,
            "httpDetectionEnabled": true,
            "networkServiceEnabled": true,
            "malwareDetectionEnabled": false,
            "hostMalwareSensorEnabled": false,
            "hostNetworkSensorEnabled": false,
            "nodeProfileServiceEnabled": false,
            "networkStreamingEnabled": false,
            "maxImageSize": 5.36870912e+09,
            "maxSBOMSize": 2.097152e+07,
            "sbomGenerationEnabled": true,
            "enableEmbeddedSBOMs": false,
            "seccompServiceEnabled": true,
            "initialDelay": "2m",
            "updateDataPeriod": "10m",
            "nodeProfileInterval": "10m",
            "networkStreamingInterval": "2m",
            "maxSniffingTimePerContainer": "24h",
            "excludeNamespaces": "kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public",
            "excludeLabels":null,
            "exporters": {
              "alertManagerExporterUrls":[],
              "stdoutExporter":true,
              "syslogExporterURL": ""
            },
            "excludeJsonPaths":null,
            "ruleCooldown": {
                "ruleCooldownDuration": "1h",
                "ruleCooldownAfterCount": 1,
                "ruleCooldownOnProfileFailure": true,
                "ruleCooldownMaxSize": 20000
            }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  28: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      selector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8f40f001a3e31db9895e7bbb06ab070f25ab66c83b31d1929b273cfd22402097
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/node-agent-config: e2e71898c111f7fdec7d4af27bd8940211a81980553cf69f97f68ab16cd250ee
            container.apparmor.security.beta.kubernetes.io/node-agent: unconfined
          labels:
            app: node-agent
            app.kubernetes.io/component: node-agent
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.30.0-rc6
            helm.sh/chart: kubescape-operator-1.30.0-rc6
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity:
            nodeAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                nodeSelectorTerms:
                  - matchExpressions:
                      - key: kubernetes.io/os
                        operator: In
                        values:
                          - linux
          automountServiceAccountToken: true
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: HOST_ROOT
                  value: /host
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NAMESPACE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBELET_ROOT
                  value: /var/lib/kubelet
                - name: AGENT_VERSION
                  value: image-based-rc6
                - name: NodeName
              image: quay.io/armosec/node-agent:image-based-rc6
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 7888
                initialDelaySeconds: 60
                periodSeconds: 3
              name: node-agent
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 7888
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 500m
                  memory: 1000Mi
                requests:
                  cpu: 100m
                  memory: 180Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_ADMIN
                    - SYS_PTRACE
                    - NET_ADMIN
                    - SYSLOG
                    - SYS_RESOURCE
                    - IPC_LOCK
                    - NET_RAW
                privileged: false
                runAsUser: 0
                seLinuxOptions:
                  type: spc_t
              volumeMounts:
                - mountPath: /host
                  name: host
                  readOnly: true
                - mountPath: /var/lib/kubelet
                  name: kubeletdir
                - mountPath: /run
                  name: run
                - mountPath: /var
                  name: var
                  readOnly: true
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/kernel/debug
                  name: debugfs
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                  readOnly: true
                - mountPath: /sys/fs/bpf
                  name: bpffs
                - mountPath: /data
                  name: data
                - mountPath: /profiles
                  name: profiles
                - mountPath: /boot
                  name: boot
                  readOnly: true
                - mountPath: /clamav
                  name: clamrun
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          hostPID: true
          imagePullSecrets:
            - name: armosec-readonly
          nodeSelector:
            kubernetes.io/os: linux
          priorityClassName: kubescape-critical
          securityContext: null
          serviceAccountName: node-agent
          tolerations: null
          volumes:
            - hostPath:
                path: /
              name: host
            - hostPath:
                path: /var/lib/kubelet
              name: kubeletdir
            - hostPath:
                path: /run
              name: run
            - hostPath:
                path: /var
              name: var
            - hostPath:
                path: /sys/fs/cgroup
              name: cgroup
            - hostPath:
                path: /lib/modules
              name: modules
            - hostPath:
                path: /sys/fs/bpf
              name: bpffs
            - hostPath:
                path: /sys/kernel/debug
              name: debugfs
            - hostPath:
                path: /boot
              name: boot
            - emptyDir: null
              name: data
            - emptyDir: null
              name: profiles
            - emptyDir: {}
              name: clamdb
            - emptyDir: {}
              name: clamrun
            - configMap:
                items:
                  - key: clamd.conf
                    path: clamd.conf
                  - key: freshclam.conf
                    path: freshclam.conf
                name: clamav
              name: etc
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: node-agent
              name: config
  29: |
    apiVersion: kubescape.io/v1
    kind: RuntimeRuleAlertBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: all-rules-all-pods
    spec:
      namespaceSelector:
        matchExpressions:
          - key: kubernetes.io/metadata.name
            operator: NotIn
            values:
              - kubescape
              - kube-system
              - kube-public
              - kube-node-lease
              - kubeconfig
              - gmp-system
              - gmp-public
      rules:
        - ruleName: Unexpected process launched
        - ruleName: Files Access Anomalies in container
        - ruleName: Syscalls Anomalies in container
        - ruleName: Linux Capabilities Anomalies in container
        - ruleName: DNS Anomalies in container
        - ruleName: Unexpected service account token access
        - ruleName: Workload uses Kubernetes API unexpectedly
        - ruleName: Process executed from malicious source
        - ruleName: Process tries to load a kernel module
        - ruleName: Drifted process executed
        - ruleName: Disallowed ssh connection
        - ruleName: Fileless execution detected
        - ruleName: Crypto miner launched
        - ruleName: Process executed from mount
        - ruleName: Crypto Mining Related Port Communication
        - ruleName: Crypto Mining Domain Communication
        - ruleName: Read Environment Variables from procfs
        - ruleName: eBPF Program Load
        - ruleName: Soft link created over sensitive file
        - ruleName: Unexpected Sensitive File Access
        - ruleName: Hard link created over sensitive file
        - ruleName: Exec to pod
        - ruleName: Port forward
        - ruleName: Unexpected Egress Network Traffic
        - ruleName: Malicious Ptrace Usage
        - ruleName: Unexpected io_uring Operation Detected
  30: |
    apiVersion: kubescape.io/v1
    kind: Rules
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: default-rules
      namespace: kubescape
    spec:
      rules:
        - description: Detects unexpected process launches that are not in the baseline
          enabled: true
          expressions:
            message: '''Unexpected process launched: '' + event.comm + '' with PID '' + string(event.pid)'
            ruleExpression:
              - eventType: exec
                expression: '!ap.was_executed(event.containerId, parse.get_exec_path(event.args, event.comm))'
            uniqueId: event.comm + '_' + event.exepath
          id: R0001
          isTriggerAlert: true
          mitreTactic: TA0002
          mitreTechnique: T1059
          name: Unexpected process launched
          profileDependency: 0
          severity: 1
          supportPolicy: false
          tags:
            - anomaly
            - process
            - exec
            - applicationprofile
        - description: Detects unexpected file access that is not in the baseline
          enabled: false
          expressions:
            message: '''Unexpected file access detected: '' + event.comm + '' with PID '' + string(event.pid) + '' to '' + event.path'
            ruleExpression:
              - eventType: open
                expression: |
                  (event.path.startsWith('/etc/') || event.path.startsWith('/var/log/') || event.path.startsWith('/var/run/') || event.path.startsWith('/run/') || event.path.startsWith('/var/spool/cron/') || event.path.startsWith('/var/www/') || event.path.startsWith('/var/lib/') || event.path.startsWith('/opt/') || event.path.startsWith('/usr/local/') || event.path.startsWith('/app/') || event.path == '/.dockerenv' || event.path == '/proc/self/environ') && !(event.path.startsWith('/run/secrets/kubernetes.io/serviceaccount') ||
                    event.path.startsWith('/var/run/secrets/kubernetes.io/serviceaccount') ||
                    event.path.startsWith('/tmp'))
                  && !ap.was_path_opened(event.containerId, event.path)
            uniqueId: event.comm + '_' + event.path
          id: R0002
          isTriggerAlert: false
          mitreTactic: TA0009
          mitreTechnique: T1005
          name: Files Access Anomalies in container
          profileDependency: 0
          severity: 1
          supportPolicy: false
          tags:
            - anomaly
            - file
            - open
            - applicationprofile
        - description: Detects unexpected system calls that are not whitelisted by application profile
          enabled: true
          expressions:
            message: '''Unexpected system call detected: '' + event.syscallName + '' with PID '' + string(event.pid)'
            ruleExpression:
              - eventType: syscall
                expression: '!ap.was_syscall_used(event.containerId, event.syscallName)'
            uniqueId: event.syscallName
          id: R0003
          isTriggerAlert: false
          mitreTactic: TA0002
          mitreTechnique: T1059
          name: Syscalls Anomalies in container
          profileDependency: 0
          severity: 1
          supportPolicy: false
          tags:
            - anomaly
            - syscall
            - applicationprofile
        - description: Detects unexpected capabilities that are not whitelisted by application profile
          enabled: true
          expressions:
            message: '''Unexpected capability used: '' + event.capName + '' in syscall '' + event.syscallName + '' with PID '' + string(event.pid)'
            ruleExpression:
              - eventType: capabilities
                expression: '!ap.was_capability_used(event.containerId, event.capName)'
            uniqueId: event.comm + '_' + event.capName
          id: R0004
          isTriggerAlert: false
          mitreTactic: TA0002
          mitreTechnique: T1059
          name: Linux Capabilities Anomalies in container
          profileDependency: 0
          severity: 1
          supportPolicy: false
          tags:
            - anomaly
            - capabilities
            - applicationprofile
        - description: Detecting unexpected domain requests that are not whitelisted by application profile.
          enabled: true
          expressions:
            message: '''Unexpected domain communication: '' + event.name + '' from: '' + event.containerName'
            ruleExpression:
              - eventType: dns
                expression: '!event.name.endsWith(''.svc.cluster.local.'') && !nn.is_domain_in_egress(event.containerId, event.name)'
            uniqueId: event.comm + '_' + event.name
          id: R0005
          isTriggerAlert: false
          mitreTactic: TA0011
          mitreTechnique: T1071.004
          name: DNS Anomalies in container
          profileDependency: 0
          severity: 1
          supportPolicy: false
          tags:
            - dns
            - anomaly
            - networkprofile
        - description: Detecting unexpected access to service account token.
          enabled: true
          expressions:
            message: '''Unexpected access to service account token: '' + event.path + '' with flags: '' + event.flags.join('','')'
            ruleExpression:
              - eventType: open
                expression: |
                  ((event.path.startsWith('/run/secrets/kubernetes.io/serviceaccount') && event.path.endsWith('/token')) ||
                   (event.path.startsWith('/var/run/secrets/kubernetes.io/serviceaccount') && event.path.endsWith('/token')) ||
                   (event.path.startsWith('/run/secrets/eks.amazonaws.com/serviceaccount') && event.path.endsWith('/token')) ||
                   (event.path.startsWith('/var/run/secrets/eks.amazonaws.com/serviceaccount') && event.path.endsWith('/token'))) &&
                  !ap.was_path_opened_with_prefix(event.containerId, '/run/secrets/kubernetes.io/serviceaccount') && !ap.was_path_opened_with_prefix(event.containerId, '/var/run/secrets/kubernetes.io/serviceaccount') && !ap.was_path_opened_with_prefix(event.containerId, '/run/secrets/eks.amazonaws.com/serviceaccount') && !ap.was_path_opened_with_prefix(event.containerId, '/var/run/secrets/eks.amazonaws.com/serviceaccount')
            uniqueId: event.comm
          id: R0006
          isTriggerAlert: true
          mitreTactic: TA0006
          mitreTechnique: T1528
          name: Unexpected service account token access
          profileDependency: 1
          severity: 5
          supportPolicy: false
          tags:
            - anomaly
            - serviceaccount
            - applicationprofile
        - description: Detecting execution of kubernetes client
          enabled: true
          expressions:
            message: 'eventType == ''exec'' ? ''Kubernetes client ('' + event.comm + '') was executed with PID '' + string(event.pid) : ''Network connection to Kubernetes API server from container '' + event.containerName'
            ruleExpression:
              - eventType: exec
                expression: (event.comm == 'kubectl' || event.exepath.endsWith('/kubectl')) && !ap.was_executed(event.containerId, parse.get_exec_path(event.args, event.comm))
              - eventType: network
                expression: event.pktType == 'OUTGOING' && k8s.is_api_server_address(event.dstAddr) && !nn.was_address_in_egress(event.containerId, event.dstAddr)
            uniqueId: 'eventType == ''exec'' ? ''exec_'' + event.comm : ''network_'' + event.dstAddr'
          id: R0007
          isTriggerAlert: true
          mitreTactic: TA0008
          mitreTechnique: T1210
          name: Workload uses Kubernetes API unexpectedly
          profileDependency: 0
          severity: 5
          supportPolicy: false
          tags:
            - exec
            - network
            - anomaly
            - applicationprofile
        - description: Detecting reading environment variables from procfs.
          enabled: true
          expressions:
            message: '''Reading environment variables from procfs: '' + event.path + '' by process '' + event.comm'
            ruleExpression:
              - eventType: open
                expression: |
                  event.path.startsWith('/proc/') && event.path.endsWith('/environ') && !ap.was_path_opened_with_suffix(event.containerId, '/environ')
            uniqueId: event.comm + '_' + event.path
          id: R0008
          isTriggerAlert: true
          mitreTactic: TA0006
          mitreTechnique: T1552.001
          name: Read Environment Variables from procfs
          profileDependency: 0
          severity: 5
          supportPolicy: false
          tags:
            - anomaly
            - procfs
            - environment
            - applicationprofile
        - description: Detecting eBPF program load.
          enabled: true
          expressions:
            message: '''bpf program load system call (bpf) was called by process ('' + event.comm + '') with command (BPF_PROG_LOAD)'''
            ruleExpression:
              - eventType: bpf
                expression: event.cmd == uint(5) && !ap.was_syscall_used(event.containerId, 'bpf')
            uniqueId: event.comm + '_' + 'bpf' + '_' + string(event.cmd)
          id: R0009
          isTriggerAlert: true
          mitreTactic: TA0005
          mitreTechnique: T1218
          name: eBPF Program Load
          profileDependency: 1
          severity: 5
          supportPolicy: false
          tags:
            - bpf
            - ebpf
            - applicationprofile
        - description: Detecting access to sensitive files.
          enabled: true
          expressions:
            message: '''Unexpected sensitive file access: '' + event.path + '' by process '' + event.comm'
            ruleExpression:
              - eventType: open
                expression: event.path.startsWith('/etc/shadow') && !ap.was_path_opened(event.containerId, event.path)
            uniqueId: event.comm + '_' + event.path
          id: R0010
          isTriggerAlert: true
          mitreTactic: TA0006
          mitreTechnique: T1005
          name: Unexpected Sensitive File Access
          profileDependency: 1
          severity: 5
          supportPolicy: false
          tags:
            - files
            - anomaly
            - applicationprofile
        - description: Detecting unexpected egress network traffic that is not whitelisted by application profile.
          enabled: false
          expressions:
            message: '''Unexpected egress network communication to: '' + event.dstAddr + '':'' + string(event.dstPort) + '' using '' + event.proto + '' from: '' + event.containerName'
            ruleExpression:
              - eventType: network
                expression: event.pktType == 'OUTGOING' && !net.is_private_ip(event.dstAddr) && !nn.was_address_in_egress(event.containerId, event.dstAddr)
            uniqueId: event.dstAddr + '_' + string(event.dstPort) + '_' + event.proto
          id: R0011
          isTriggerAlert: false
          mitreTactic: TA0010
          mitreTechnique: T1041
          name: Unexpected Egress Network Traffic
          profileDependency: 0
          severity: 5
          supportPolicy: false
          tags:
            - whitelisted
            - network
            - anomaly
            - networkprofile
        - description: 'Detecting exec calls that are from malicious source like: /dev/shm'
          enabled: true
          expressions:
            message: '''Execution from malicious source: '' + event.exepath + '' in directory '' + event.cwd'
            ruleExpression:
              - eventType: exec
                expression: |
                  (event.exepath == '/dev/shm' || event.exepath.startsWith('/dev/shm/')) || (event.cwd == '/dev/shm' || event.cwd.startsWith('/dev/shm/') || (parse.get_exec_path(event.args, event.comm).startsWith('/dev/shm/')))
            uniqueId: event.comm + '_' + event.exepath + '_' + event.pcomm
          id: R1000
          isTriggerAlert: true
          mitreTactic: TA0002
          mitreTechnique: T1059
          name: Process executed from malicious source
          profileDependency: 2
          severity: 8
          supportPolicy: false
          tags:
            - exec
            - signature
            - malicious
        - description: Detecting exec calls of binaries that are not included in the base image
          enabled: true
          expressions:
            message: '''Process ('' + event.comm + '') was executed and is not part of the image'''
            ruleExpression:
              - eventType: exec
                expression: |
                  (event.upperlayer == true ||
                   event.pupperlayer == true) &&
                  !ap.was_executed(event.containerId, parse.get_exec_path(event.args, event.comm))
            uniqueId: event.comm + '_' + event.exepath + '_' + event.pcomm
          id: R1001
          isTriggerAlert: true
          mitreTactic: TA0005
          mitreTechnique: T1036
          name: Drifted process executed
          profileDependency: 1
          severity: 8
          supportPolicy: false
          tags:
            - exec
            - malicious
            - binary
            - base image
            - applicationprofile
        - description: Detecting Kernel Module Load.
          enabled: true
          expressions:
            message: '''Kernel module ('' + event.module + '') loading attempt with syscall ('' + event.syscallName + '') was called by process ('' + event.comm + '')'''
            ruleExpression:
              - eventType: kmod
                expression: event.syscallName == 'init_module' || event.syscallName == 'finit_module'
            uniqueId: event.comm + '_' + event.syscallName + '_' + event.module
          id: R1002
          isTriggerAlert: true
          mitreTactic: TA0005
          mitreTechnique: T1547.006
          name: Process tries to load a kernel module
          profileDependency: 2
          severity: 10
          supportPolicy: false
          tags:
            - kmod
            - kernel
            - module
            - load
        - description: Detecting ssh connection to disallowed port
          enabled: false
          expressions:
            message: '''Malicious SSH connection attempt to '' + event.dstIp + '':'' + string(dyn(event.dstPort))'
            ruleExpression:
              - eventType: ssh
                expression: dyn(event.srcPort) >= 32768 && dyn(event.srcPort) <= 60999 && !(dyn(event.dstPort) in [22, 2022]) && !nn.was_address_in_egress(event.containerId, event.dstIp)
            uniqueId: event.comm + '_' + event.dstIp + '_' + string(dyn(event.dstPort))
          id: R1003
          isTriggerAlert: true
          mitreTactic: TA0008
          mitreTechnique: T1021.001
          name: Disallowed ssh connection
          profileDependency: 1
          severity: 5
          supportPolicy: false
          tags:
            - ssh
            - connection
            - port
            - malicious
            - networkprofile
        - description: Detecting exec calls from mounted paths.
          enabled: true
          expressions:
            message: '''Process ('' + event.comm + '') was executed from a mounted path'''
            ruleExpression:
              - eventType: exec
                expression: '!ap.was_executed(event.containerId, parse.get_exec_path(event.args, event.comm)) && k8s.get_container_mount_paths(event.namespace, event.podName, event.containerName).exists(mount, event.exepath.startsWith(mount) || parse.get_exec_path(event.args, event.comm).startsWith(mount))'
            uniqueId: event.comm + '_' + event.exepath + '_'
          id: R1004
          isTriggerAlert: true
          mitreTactic: TA0002
          mitreTechnique: T1059
          name: Process executed from mount
          profileDependency: 1
          severity: 5
          supportPolicy: false
          tags:
            - exec
            - mount
            - applicationprofile
        - description: Detecting Fileless Execution
          enabled: true
          expressions:
            message: '''Fileless execution detected: exec call "'' + event.comm + ''" is from a malicious source'''
            ruleExpression:
              - eventType: exec
                expression: event.exepath.contains('memfd') || event.exepath.startsWith('/proc/self/fd') || event.exepath.matches('/proc/[0-9]+/fd/[0-9]+')
            uniqueId: event.comm + '_' + event.exepath + '_' + event.pcomm
          id: R1005
          isTriggerAlert: true
          mitreTactic: TA0005
          mitreTechnique: T1055
          name: Fileless execution detected
          profileDependency: 2
          severity: 8
          supportPolicy: false
          tags:
            - fileless
            - execution
            - malicious
        - description: Detecting Unshare System Call usage, which can be used to escape container.
          enabled: true
          expressions:
            message: '''Unshare system call (unshare) was called by process ('' + event.comm + '')'''
            ruleExpression:
              - eventType: unshare
                expression: '!ap.was_syscall_used(event.containerId, ''unshare'')'
            uniqueId: event.comm + '_' + 'unshare'
          id: R1006
          isTriggerAlert: true
          mitreTactic: TA0004
          mitreTechnique: T1611
          name: Process tries to escape container
          profileDependency: 2
          severity: 5
          supportPolicy: false
          tags:
            - unshare
            - escape
            - unshare
            - anomaly
            - applicationprofile
        - description: Detecting XMR Crypto Miners by randomx algorithm usage.
          enabled: true
          expressions:
            message: '''XMR Crypto Miner process: ('' + event.exepath + '') executed'''
            ruleExpression:
              - eventType: randomx
                expression: "true"
            uniqueId: event.exepath + '_' + event.comm
          id: R1007
          isTriggerAlert: true
          mitreTactic: TA0040
          mitreTechnique: T1496
          name: Crypto miner launched
          profileDependency: 2
          severity: 10
          supportPolicy: false
          tags:
            - crypto
            - miners
            - malicious
        - description: Detecting Crypto miners communication by domain
          enabled: true
          expressions:
            message: '''Communication with a known crypto mining domain: '' + event.name'
            ruleExpression:
              - eventType: dns
                expression: event.name in ['2cryptocalc.com.', '2miners.com.', 'antpool.com.', 'asia1.ethpool.org.', 'bohemianpool.com.', 'botbox.dev.', 'btm.antpool.com.', 'c3pool.com.', 'c4pool.org.', 'ca.minexmr.com.', 'cn.stratum.slushpool.com.', 'dash.antpool.com.', 'data.miningpoolstats.stream.', 'de.minexmr.com.', 'eth-ar.dwarfpool.com.', 'eth-asia.dwarfpool.com.', 'eth-asia1.nanopool.org.', 'eth-au.dwarfpool.com.', 'eth-au1.nanopool.org.', 'eth-br.dwarfpool.com.', 'eth-cn.dwarfpool.com.', 'eth-cn2.dwarfpool.com.', 'eth-eu.dwarfpool.com.', 'eth-eu1.nanopool.org.', 'eth-eu2.nanopool.org.', 'eth-hk.dwarfpool.com.', 'eth-jp1.nanopool.org.', 'eth-ru.dwarfpool.com.', 'eth-ru2.dwarfpool.com.', 'eth-sg.dwarfpool.com.', 'eth-us-east1.nanopool.org.', 'eth-us-west1.nanopool.org.', 'eth-us.dwarfpool.com.', 'eth-us2.dwarfpool.com.', 'eth.antpool.com.', 'eu.stratum.slushpool.com.', 'eu1.ethermine.org.', 'eu1.ethpool.org.', 'fastpool.xyz.', 'fr.minexmr.com.', 'kriptokyng.com.', 'mine.moneropool.com.', 'mine.xmrpool.net.', 'miningmadness.com.', 'monero.cedric-crispin.com.', 'monero.crypto-pool.fr.', 'monero.fairhash.org.', 'monero.hashvault.pro.', 'monero.herominers.com.', 'monerod.org.', 'monerohash.com.', 'moneroocean.stream.', 'monerop.com.', 'multi-pools.com.', 'p2pool.io.', 'pool.kryptex.com.', 'pool.minexmr.com.', 'pool.monero.hashvault.pro.', 'pool.rplant.xyz.', 'pool.supportxmr.com.', 'pool.xmr.pt.', 'prohashing.com.', 'rx.unmineable.com.', 'sg.minexmr.com.', 'sg.stratum.slushpool.com.', 'skypool.org.', 'solo-xmr.2miners.com.', 'ss.antpool.com.', 'stratum-btm.antpool.com.', 'stratum-dash.antpool.com.', 'stratum-eth.antpool.com.', 'stratum-ltc.antpool.com.', 'stratum-xmc.antpool.com.', 'stratum-zec.antpool.com.', 'stratum.antpool.com.', 'supportxmr.com.', 'trustpool.cc.', 'us-east.stratum.slushpool.com.', 'us1.ethermine.org.', 'us1.ethpool.org.', 'us2.ethermine.org.', 'us2.ethpool.org.', 'web.xmrpool.eu.', 'www.domajorpool.com.', 'www.dxpool.com.', 'www.mining-dutch.nl.', 'xmc.antpool.com.', 'xmr-asia1.nanopool.org.', 'xmr-au1.nanopool.org.', 'xmr-eu1.nanopool.org.', 'xmr-eu2.nanopool.org.', 'xmr-jp1.nanopool.org.', 'xmr-us-east1.nanopool.org.', 'xmr-us-west1.nanopool.org.', 'xmr.2miners.com.', 'xmr.crypto-pool.fr.', 'xmr.gntl.uk.', 'xmr.nanopool.org.', 'xmr.pool-pay.com.', 'xmr.pool.minergate.com.', 'xmr.solopool.org.', 'xmr.volt-mine.com.', 'xmr.zeropool.io.', 'zec.antpool.com.', 'zergpool.com.', 'auto.c3pool.org.', 'us.monero.herominers.com.']
            uniqueId: event.name + '_' + event.comm
          id: R1008
          isTriggerAlert: true
          mitreTactic: TA0011
          mitreTechnique: T1071.004
          name: Crypto Mining Domain Communication
          profileDependency: 2
          severity: 10
          supportPolicy: false
          tags:
            - network
            - crypto
            - miners
            - malicious
            - dns
        - description: Detecting Crypto Miners by suspicious port usage.
          enabled: true
          expressions:
            message: '''Detected crypto mining related port communication on port '' + string(event.dstPort) + '' to '' + event.dstAddr + '' with protocol '' + event.proto'
            ruleExpression:
              - eventType: network
                expression: event.proto == 'TCP' && event.pktType == 'OUTGOING' && event.dstPort in [3333, 45700] && !nn.was_address_in_egress(event.containerId, event.dstAddr)
            uniqueId: event.comm + '_' + string(event.dstPort)
          id: R1009
          isTriggerAlert: false
          mitreTactic: TA0011
          mitreTechnique: T1071
          name: Crypto Mining Related Port Communication
          profileDependency: 1
          severity: 3
          supportPolicy: false
          tags:
            - network
            - crypto
            - miners
            - malicious
            - networkprofile
        - description: Detects symlink creation over sensitive files
          enabled: true
          expressions:
            message: '''Symlink created over sensitive file: '' + event.oldPath + '' -> '' + event.newPath'
            ruleExpression:
              - eventType: symlink
                expression: (event.oldPath.startsWith('/etc/shadow') || event.oldPath.startsWith('/etc/sudoers')) && !ap.was_path_opened(event.containerId, event.oldPath)
            uniqueId: event.comm + '_' + event.oldPath
          id: R1010
          isTriggerAlert: true
          mitreTactic: TA0006
          mitreTechnique: T1005
          name: Soft link created over sensitive file
          profileDependency: 1
          severity: 5
          supportPolicy: true
          tags:
            - anomaly
            - symlink
            - applicationprofile
        - description: Detecting ld_preload hook techniques.
          enabled: false
          expressions:
            message: 'eventType == ''exec'' ? ''Process ('' + event.comm + '') is using a dynamic linker hook: '' + process.get_ld_hook_var(event.pid) : ''The dynamic linker configuration file ('' + event.path + '') was modified by process ('' + event.comm + '')'''
            ruleExpression:
              - eventType: exec
                expression: event.comm != 'java' && event.containerName != 'matlab' && process.get_ld_hook_var(event.pid) != ''
              - eventType: open
                expression: event.path == '/etc/ld.so.preload' && has(event.flagsRaw) && event.flagsRaw != 0
            uniqueId: 'eventType == ''exec'' ? ''exec_'' + event.comm : ''open_'' + event.path'
          id: R1011
          isTriggerAlert: true
          mitreTactic: TA0005
          mitreTechnique: T1574.006
          name: ld_preload hooks technique detected
          profileDependency: 1
          severity: 5
          supportPolicy: true
          tags:
            - exec
            - malicious
            - applicationprofile
        - description: Detecting hardlink creation over sensitive files.
          enabled: true
          expressions:
            message: '''Hardlink created over sensitive file: '' + event.oldPath + '' - '' + event.newPath'
            ruleExpression:
              - eventType: hardlink
                expression: (event.oldPath.startsWith('/etc/shadow') || event.oldPath.startsWith('/etc/sudoers')) && !ap.was_path_opened(event.containerId, event.oldPath)
            uniqueId: event.comm + '_' + event.oldPath
          id: R1012
          isTriggerAlert: true
          mitreTactic: TA0006
          mitreTechnique: T1005
          name: Hard link created over sensitive file
          profileDependency: 1
          severity: 5
          supportPolicy: true
          tags:
            - files
            - malicious
            - applicationprofile
        - description: Detecting potentially malicious ptrace usage.
          enabled: true
          expressions:
            message: '''Malicious ptrace usage detected from: '' + event.comm'
            ruleExpression:
              - eventType: ptrace
                expression: "true"
            uniqueId: event.exepath + '_' + event.comm
          id: R1015
          isTriggerAlert: true
          mitreTactic: TA0005
          mitreTechnique: T1622
          name: Malicious Ptrace Usage
          profileDependency: 2
          severity: 5
          supportPolicy: false
          tags:
            - process
            - malicious
        - description: Detects io_uring operations that were not recorded during the initial observation period, indicating potential unauthorized activity.
          enabled: true
          expressions:
            message: '''Unexpected io_uring operation detected: (opcode='' + string(event.opcode) + '') flags=0x'' + (has(event.flagsRaw) ? string(event.flagsRaw) : ''0'') + '' in '' + event.comm + ''.'''
            ruleExpression:
              - eventType: iouring
                expression: "true"
            uniqueId: string(event.opcode) + '_' + event.comm
          id: R1030
          isTriggerAlert: true
          mitreTactic: TA0002
          mitreTechnique: T1218
          name: Unexpected io_uring Operation Detected
          profileDependency: 0
          severity: 5
          supportPolicy: true
          tags:
            - syscalls
            - io_uring
            - applicationprofile
  31: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      ports:
        - name: prometheus
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  32: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  33: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-admission-webhook
      namespace: kubescape
    spec:
      ports:
        - port: 443
          targetPort: 8443
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  34: |
    apiVersion: v1
    data:
      tls.crt: bW9jay1jZXJ0LWNlcnQ=
      tls.key: bW9jay1jZXJ0LWtleQ==
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-admission-webhook.kubescape.svc-kubescape-tls-pair
      namespace: kubescape
    type: kubernetes.io/tls
  35: |
    apiVersion: admissionregistration.k8s.io/v1
    kind: ValidatingWebhookConfiguration
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: validation
    webhooks:
      - admissionReviewVersions:
          - v1
        clientConfig:
          caBundle: bW9jay1jYS1jZXJ0
          service:
            name: kubescape-admission-webhook
            namespace: kubescape
            path: /validate
            port: 443
        failurePolicy: Ignore
        name: validation.kubescape.admission
        rules:
          - apiGroups:
              - '*'
            apiVersions:
              - v1
            operations:
              - CREATE
              - UPDATE
              - DELETE
              - CONNECT
            resources:
              - pods
              - pods/exec
              - pods/portforward
              - pods/attach
              - clusterrolebindings
              - rolebindings
            scope: '*'
        sideEffects: None
  36: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - nodes
          - namespaces
          - configmaps
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
          - openvulnerabilityexchangecontainers
          - containerprofiles
          - sbomsyfts
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
          - get
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
  37: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  38: |
    apiVersion: v1
    data:
      config.json: |
        {
          "excludeNamespaces": "kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public",
          "namespace": "kubescape",
          "triggersecurityframework": true,
          "podScanGuardTime": "1h",
          "excludeJsonPaths":null,
          "rulesUpdateConfig": {
            "Enabled": true,
            "Interval": "5m",
            "Namespace": "kubescape"
          },
          "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  39: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/capabilities-config: aa6b311685d6b4fe5ab7c448327a9836ad64c3cd4f78f75718b66015a03915a0
            checksum/cloud-config: 8f40f001a3e31db9895e7bbb06ab070f25ab66c83b31d1929b273cfd22402097
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/matching-rules-config: c81857b415602f6b161db3199a16461c5acd8ba44ec7572189441f4f294a3614
            checksum/operator-config: ef87142a670d23a768252cd4501c4e295dcb4020dfa70a5da6aa658d1e3bf269
          labels:
            app: operator
            app.kubernetes.io/component: operator
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.30.0-rc6
            helm.sh/chart: kubescape-operator-1.30.0-rc6
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: HELM_RELEASE
                  value: kubescape-operator-1.30.0-rc6
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
              image: quay.io/kubescape/operator:v0.2.115
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: readiness-port
                initialDelaySeconds: 3
                periodSeconds: 3
              name: operator
              ports:
                - containerPort: 4002
                  name: trigger-port
                  protocol: TCP
                - containerPort: 8000
                  name: readiness-port
                  protocol: TCP
                - containerPort: 8443
                  name: admission-port
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: readiness-port
                initialDelaySeconds: 10
                periodSeconds: 5
              resources:
                limits:
                  cpu: 300m
                  memory: 300Mi
                requests:
                  cpu: 50m
                  memory: 100Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/capabilities.json
                  name: ks-capabilities
                  readOnly: true
                  subPath: capabilities.json
                - mountPath: /etc/config/matchingRules.json
                  name: cs-matching-rules
                  readOnly: true
                  subPath: matchingRules.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/certs
                  name: tls-certs
                  readOnly: true
          imagePullSecrets:
            - name: armosec-readonly
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: operator
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: tls-certs
              secret:
                secretName: kubescape-admission-webhook.kubescape.svc-kubescape-tls-pair
            - emptyDir: {}
              name: tmp-dir
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: capabilities
                    path: capabilities.json
                name: ks-capabilities
              name: ks-capabilities
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: operator
              name: config
            - configMap:
                items:
                  - key: matchingRules.json
                    path: matchingRules.json
                name: cs-matching-rules
              name: cs-matching-rules
  40: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubescape-scheduler
          namespace: kubescape
          labels:
            app: kubescape-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "kubescape-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "kubescape-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: armosec-readonly
                  containers:
                  - name: kubescape-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.15"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubescape
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubescape-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-cronjob-template
      namespace: kubescape
  41: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubevuln-scheduler
          namespace: kubescape
          labels:
            app: kubevuln-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "vuln-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "vuln-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: armosec-readonly
                  containers:
                  - name: kubevuln-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.15"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubevuln-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-cronjob-template
      namespace: kubescape
  42: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: registry-scheduler
          namespace: kubescape
          labels:
            app: registry-scheduler
            kubescape.io/tier: "core"
            tier: ks-control-plane
            armo.tier: "registry-scan"
        spec:
          schedule: "0 0 * * *"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "registry-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: armosec-readonly
                  containers:
                  - name: registry-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.15"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: registry-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: registry-scan-cronjob-template
      namespace: kubescape
  43: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  44: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  45: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      ports:
        - port: 4002
          protocol: TCP
          targetPort: 4002
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  46: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  47: |
    apiVersion: apiregistration.k8s.io/v1
    kind: APIService
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: v1beta1.spdx.softwarecomposition.kubescape.io
    spec:
      caBundle: bW9jay1jYS1jZXJ0
      group: spdx.softwarecomposition.kubescape.io
      groupPriorityMinimum: 1000
      service:
        name: storage
        namespace: kubescape
      version: v1beta1
      versionPriority: 15
  48: |
    apiVersion: v1
    data:
      ca.crt: bW9jay1jYS1jZXJ0
      tls.crt: bW9jay1jZXJ0LWNlcnQ=
      tls.key: bW9jay1jZXJ0LWtleQ==
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-ca
      namespace: kubescape
    type: kubernetes.io/tls
  49: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    rules:
      - apiGroups:
          - ""
        resources:
          - namespaces
          - pods
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - daemonsets
          - deployments
          - replicasets
          - statefulsets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - cronjobs
          - jobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - flowcontrol.apiserver.k8s.io
        resources:
          - prioritylevelconfigurations
          - flowschemas
        verbs:
          - get
          - watch
          - list
  50: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage:system:auth-delegator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:auth-delegator
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  51: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: storage
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  52: |
    apiVersion: v1
    data:
      config.json: |
        {
          "cleanupInterval": "6h",
          "disableVirtualCRDs": false,
          "excludeJsonPaths": null,
          "defaultQueueLength": 100,
          "defaultWorkerCount": 2,
          "defaultMaxObjectSize": 400000,
          "queueManagerEnabled": true,
          "kindQueues": {"applicationprofiles":{"maxObjectSize":20000000,"queueLength":50,"workerCount":2},"containerprofiles":{"maxObjectSize":2500000,"queueLength":50,"workerCount":2},"networkneighborhoods":{"maxObjectSize":10000000,"queueLength":50,"workerCount":2},"openvulnerabilityexchangecontainers":{"maxObjectSize":500000,"queueLength":50,"workerCount":1},"sbomsyftfiltereds":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1},"sbomsyfts":{"maxObjectSize":100000000,"queueLength":50,"workerCount":1},"vulnerabilitymanifests":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1}},
          "tlsClientCaFile": "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt",
          "tlsServerCertFile": "/etc/storage-ca-certificates/tls.crt",
          "tlsServerKeyFile": "/etc/storage-ca-certificates/tls.key",
          "serverBindPort": "8443"
        }
    kind: ConfigMap
    metadata:
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  53: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: storage
            app.kubernetes.io/component: storage
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.30.0-rc6
            helm.sh/chart: kubescape-operator-1.30.0-rc6
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
              image: quay.io/kubescape/storage:v0.0.227
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8443
                  scheme: HTTPS
              name: apiserver
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8443
                  scheme: HTTPS
              resources:
                limits:
                  cpu: 1500m
                  memory: 1500Mi
                requests:
                  cpu: 100m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: data
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/storage-ca-certificates
                  name: ca-certificates
                  readOnly: true
          imagePullSecrets:
            - name: armosec-readonly
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: storage
          tolerations: null
          volumes:
            - name: data
              persistentVolumeClaim:
                claimName: kubescape-storage
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: storage
              name: config
            - name: ca-certificates
              secret:
                secretName: storage-ca
  54: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-storage
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  55: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-auth-reader
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  56: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      ports:
        - name: https
          port: 443
          protocol: TCP
          targetPort: 8443
      selector:
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  57: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.30.0-rc6
        helm.sh/chart: kubescape-operator-1.30.0-rc6
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
